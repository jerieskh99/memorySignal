**README.md** for **Pillar 3 — Coherence (Temporal & Spectral Stability)**.
It includes:
✔ Full conceptual motivation
✔ Mathematical definitions
✔ Explanation of real projections of a complex signal
✔ Implementation guidelines
✔ Expected results & interpretation

---

# **Pillar 3 — Coherence (Temporal & Spectral Stability)**

### *Validation of Temporal Stability, Phase Consistency, and Spectral Structure in Memory-Derived Signals*

---

## **1. Overview**

Pillar 3 evaluates whether the **memory-delta signal** generated by the complex-valued representation:

[
\Delta_t(n) = |\Delta_t(n)| e^{j 2\pi \Delta^{\text{phase}}_t(n)}
]

exhibits **stable behavior over time** under *normal, clean system activity*.

This pillar answers the question:

> **“Does the signal behave like a meaningful physical signal with stable temporal and spectral structure, rather than random noise?”**

A stable and coherent signal is essential if the model is to perform reliable anomaly detection, generalize across machines, and preserve the underlying behavior of memory activity.

---

## **2. Why This Pillar Matters**

A forensic / anomaly-detection pipeline is only as useful as the **signal fed into the model**.
If the signal is:

* inconsistent
* noisy
* unstable across sessions
* or changes unpredictably across machines

then no ML model—autoencoder, LSTM, classifier—will learn meaningful structure.

Pillar 3 ensures three key properties:

### ✔ **Temporal Stability**

The phase evolution is consistent over time.

### ✔ **Spectral Stability**

Dominant frequencies and cross-spectral relationships persist across runs.

### ✔ **Reproducibility Across Machines & Days**

Repeated execution of the same routine yields similar signals.

Only if these properties hold can downstream ML models reliably learn *normal behavior* and distinguish anomalies.

---

## **3. Important Note — Complex Signal vs Real Projections**

Your delta representation is **complex-valued**, containing:

* **Magnitude** → Hamming distance (extent of change)
* **Phase** → Cosine similarity angle (direction of change)

However:
**Each metric in Pillar 3 uses a *real-valued projection* of the complex signal.**

This is absolutely intentional and matches signal-processing literature.

### ✔ Metric → Real Component Used

| Metric                                | Input Used                       | Why?                                    |   |                                             |
| ------------------------------------- | -------------------------------- | --------------------------------------- | - | ------------------------------------------- |
| **PLV (Phase-Locking Value)**         | Phase: (\phi_t = \arg(\Delta_t)) | Phase stability is a temporal measure.  |   |                                             |
| **MSC (Magnitude-Squared Coherence)** | Magnitude: (                     | \Delta_t                                | ) | Spectral relationships depend on amplitude. |
| **Cepstral Stability**                | Log-spectrum of (                | \Delta_t                                | ) | Cepstrum is defined on real magnitudes.     |
| **SNR of Coherence**                  | Magnitude-based coherence        | Peak vs noise-floor in spectral domain. |   |                                             |
| **Test–Retest (ICC/r)**               | Either                           | Depends on stability test.              |   |                                             |

This division is important:

* **Phase metrics evaluate directionality & synchrony**
* **Magnitude metrics evaluate spectral stability**

Working with real projections enables the use of *efficient real FFT (rFFT)* and aligns with standard DSP theory.

---

## **4. Data Model**

### **Input Matrix**

Your pipeline produces:

```
time_series: np.ndarray[shape = (T, N)]
```

Where:

* **T** = number of snapshots (time axis)
* **N** = number of memory pages
* **time_series[t, n] = Δ_t(n)** (complex value)

Each metric operates **per-page**, using either:

* the magnitude time series: (|\Delta_t(n)|)
* the phase time series: (\arg(\Delta_t(n)))

---

## **5. Metrics and Definitions**

### **5.1 Phase-Locking Value (PLV)**

Measures phase consistency across time.

Extract phase series:

[
\phi_t(n) = \arg(\Delta_t(n))
]

PLV is:

[
\text{PLV}(n)
= \left|
\frac{1}{T} \sum_{t=1}^{T} e^{j\phi_t(n)}
\right|
]

**Interpretation:**

| PLV value   | Meaning                     |
| ----------- | --------------------------- |
| ~1.0        | Phase is perfectly stable   |
| >0.7        | Clean, normal system        |
| Drop ≥ −0.2 | Possible behavioral anomaly |

This is similar to neural synchrony metrics used in EEG/MEG analysis.

---

### **5.2 Magnitude-Squared Coherence (MSC)**

Measures spectral consistency between adjacent time intervals.

Use magnitude trace:

[
x(t) = |\Delta_t(n)|
]

Define:

* ( S_{xx}(f) ): PSD of x
* ( S_{yy}(f) ): PSD of y
* ( S_{xy}(f) ): cross-spectrum

Then:

[
C_{xy}(f) =
\frac{|S_{xy}(f)|^2}{S_{xx}(f) S_{yy}(f)}
]

MSC reflects **how frequency components evolve together over time**.

---

### **5.3 Coherence Peak SNR**

Peak coherence:

[
P_{\text{peak}} = \max_f C_{xy}(f)
]

Noise floor:

[
P_{\text{noise}} = \text{median}(C_{xy}(f))
]

Signal-to-Noise Ratio:

[
\text{SNR} = 10 \log_{10} \left( \frac{P_{\text{peak}}}{P_{\text{noise}}} \right)
]

Expectation:

* **> 10 dB** for periodic/structured clean routines
* significant drops during anomalies

---

### **5.4 Cepstral Stability (Cepstral Peak CV%)**

Cepstrum of magnitude signal:

[
C(k) = \left| \mathcal{F}^{-1}\left( \log (|\mathcal{F}(x)|) \right) \right|
]

Dominant cepstral peak (quefrency):

[
k^* = \arg\max_k C(k)
]

Across repeated runs:

[
\text{CV%} = 100 \cdot \frac{\sigma(C_r(k^*))}{\mu(C_r(k^*))}
]

Expect:

* **< 15%** for clean stable routines
* **> 40%** if behavior changes

---

### **5.5 Test–Retest Reliability**

Measures reproducibility across days/machines.

#### **Pearson Correlation**

[
r =
\frac{\mathrm{cov}(X, Y)}
{\sigma_X \sigma_Y}
]

Expect **r ≥ 0.8**.

#### **ICC(3,1)** (Gold-standard reliability metric)

[
ICC(3,1)
========

\frac{MS_B - MS_E}
{MS_B + (k-1)MS_E}
]

Expect **ICC ≥ 0.8**.

---

## **6. Implementation Notes**

### ✔ FFT Axis

FFT must be computed along the **time axis**:

```
axis=0
```

### ✔ Choosing rFFT vs full FFT

| Situation                    | Use          |   |               |
| ---------------------------- | ------------ | - | ------------- |
| Magnitude-only input (       | \Delta       | ) | `np.fft.rfft` |
| Phase or full complex signal | `np.fft.fft` |   |               |

Since both coherence and cepstrum use **real magnitudes**,
**rFFT is correct, faster, and memory-efficient.**

---

## **7. Expected Evaluation Outputs**

Your experiments should produce:

### **PLV Violin/Box Plots**

* Median PLV > 0.7 for clean data
* Sharp drop under anomalies

### **Spectrogram + Coherence Peaks**

* Clear dominant spectral bands under normal behavior
* Flattening / loss of structure during anomalies

### **Cepstral CV% Bar Chart**

* CV < 15% across repeats
* CV > 40% when behavior changes

### **ICC/Correlation Tables**

* ICC ≥ 0.8 across machines/days

These are reviewer-friendly and match best practices in neuroscience/DSP.

---

## **8. Summary**

Pillar 3 validates that your signal:

* has **stable temporal structure** (PLV)
* preserves **consistent spectral fingerprints** (MSC + SNR)
* exhibits **reproducible periodicity** (Cepstral Stability)
* remains **reliable across machines and days** (ICC/r)

Even though the underlying representation is **complex-valued**,
every metric uses a **purposeful real-valued projection**:
phase for temporal synchrony, magnitude for spectral stability.

This ensures both **theoretical correctness** and **efficient computation**
while maintaining fidelity to the original complex signal.

---